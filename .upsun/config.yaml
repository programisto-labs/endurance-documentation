# Configuration Upsun pour Endurance Documentation (Docusaurus)

applications:
  # Application Documentation (Docusaurus)
  documentation:
    type: nodejs:22
    container_profile: BALANCED
    build:
      flavor: none
    web:
      commands:
        start: npm start -- --port $PORT --host 0.0.0.0
      upstream:
        socket_family: tcp
      locations:
        "/":
          passthru: true
        "/img":
          passthru: true
    mounts:
      ".docusaurus":
        source: local
        source_path: .docusaurus
    hooks:
      build: |
        set -eux
        echo "ðŸ“¦ Installation des dÃ©pendances..."
        npm install
      deploy: |
        set -eux
        echo "ðŸš€ Documentation Endurance dÃ©ployÃ©e avec succÃ¨s"

# Routes pour l'application
routes:
  # Route principale pour la documentation
  "https://{default}/":
    type: upstream
    upstream: "documentation:http"
  
  # Redirection www vers le domaine principal
  "https://www.{default}/":
    type: redirect
    to: "https://{default}/"
  
  # Redirection HTTP vers HTTPS
  "http://{default}/":
    type: redirect
    to: "https://{default}/"
  
  "http://www.{default}/":
    type: redirect
    to: "https://{default}/"